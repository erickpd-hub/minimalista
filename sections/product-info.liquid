{% comment %}
  Sección de Información del Producto
{% endcomment %}

<div class="px-4 py-16 mx-auto max-w-7xl">
  <div class="grid gap-12 lg:grid-cols-2">
    <!-- Galería de imágenes -->
    <div>
      {% if product.images.size > 0 %}
        <div class="mb-4 overflow-hidden rounded-lg aspect-square bg-neutral-50">
          <img 
            id="main-product-image"
            src="{{ product.featured_image | img_url: '800x800' }}" 
            alt="{{ product.title | escape }}"
            class="object-cover w-full h-full"
          >
        </div>
        
        {% if product.images.size > 1 %}
          <div class="grid grid-cols-4 gap-4">
            {% for image in product.images limit: 4 %}
              <button 
                class="overflow-hidden border-2 rounded-lg aspect-square border-neutral-200 hover:border-neutral-900"
                onclick="changeImage('{{ image | img_url: '800x800' }}')"
              >
                <img 
                  src="{{ image | img_url: '200x200' }}" 
                  alt="{{ product.title | escape }}"
                  class="object-cover w-full h-full"
                >
              </button>
            {% endfor %}
          </div>
        {% endif %}
      {% endif %}
    </div>

    <!-- Información del producto -->
    <div>
      <h1 class="mb-4">{{ product.title }}</h1>
      
      <div class="mb-6">
        <span class="text-neutral-900">
          {{ product.price | money }}
        </span>
        {% if product.compare_at_price > product.price %}
          <span class="ml-2 text-neutral-500 line-through">
            {{ product.compare_at_price | money }}
          </span>
        {% endif %}
      </div>

      {% form 'product', product, id: 'product-form' %}
        {% if product.variants.size > 1 %}
          <div class="mb-6">
            <label for="product-select" class="block mb-2">Variante</label>
            <select 
              name="id" 
              id="product-select"
              class="w-full px-4 py-2 border rounded-lg border-neutral-300 focus:border-neutral-900 focus:outline-none"
            >
              {% for variant in product.variants %}
                <option 
                  value="{{ variant.id }}"
                  {% unless variant.available %}disabled{% endunless %}
                >
                  {{ variant.title }} - {{ variant.price | money }}
                  {% unless variant.available %} (Agotado){% endunless %}
                </option>
              {% endfor %}
            </select>
          </div>
        {% else %}
          <input type="hidden" name="id" value="{{ product.variants.first.id }}">
        {% endif %}

        <div class="mb-6">
          <label for="quantity" class="block mb-2">Cantidad</label>
          <div class="flex items-center gap-2">
            <button 
              type="button" 
              class="px-4 py-2 border rounded-lg border-neutral-300 hover:bg-neutral-100"
              onclick="decrementQuantity()"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path>
              </svg>
            </button>
            
            <input 
              type="number" 
              id="quantity" 
              name="quantity" 
              value="1" 
              min="1"
              class="w-20 px-4 py-2 text-center border rounded-lg border-neutral-300 focus:border-neutral-900 focus:outline-none"
            >
            
            <button 
              type="button" 
              class="px-4 py-2 border rounded-lg border-neutral-300 hover:bg-neutral-100"
              onclick="incrementQuantity()"
            >
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path>
              </svg>
            </button>
          </div>
        </div>

        <button 
          type="submit" 
          name="add"
          class="w-full gap-2 px-6 py-3 text-white transition-colors bg-black rounded-lg hover:bg-neutral-800 disabled:bg-neutral-300 disabled:cursor-not-allowed"
          {% unless product.available %}disabled{% endunless %}
        >
          <svg class="inline w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
          </svg>
          {% if product.available %}
            Agregar al carrito
          {% else %}
            Agotado
          {% endif %}
        </button>
      {% endform %}

      {% if product.metafields.custom.specs != blank %}
        <div class="p-4 mt-6 border rounded-lg border-neutral-200 bg-neutral-50">
          <h3 class="mb-3">Especificaciones</h3>
          <ul class="space-y-2 text-neutral-600">
            {% assign specs = product.metafields.custom.specs | split: '|' %}
            {% for spec in specs %}
              <li>{{ spec }}</li>
            {% endfor %}
          </ul>
        </div>
      {% endif %}
    </div>
  </div>
</div>

<script>
  function changeImage(url) {
    document.getElementById('main-product-image').src = url;
  }

  function incrementQuantity() {
    const input = document.getElementById('quantity');
    input.value = parseInt(input.value) + 1;
  }

  function decrementQuantity() {
    const input = document.getElementById('quantity');
    if (parseInt(input.value) > 1) {
      input.value = parseInt(input.value) - 1;
    }
  }
</script>

{% schema %}
{
  "name": "Product Info",
  "settings": [
    {
      "type": "checkbox",
      "id": "enable_quantity_selector",
      "label": "Habilitar selector de cantidad",
      "default": true
    }
  ],
  "presets": [
    {
      "name": "Product Info"
    }
  ]
}
{% endschema %}
